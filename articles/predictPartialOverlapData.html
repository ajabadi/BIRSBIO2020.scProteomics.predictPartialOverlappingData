<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Predicting the missing samples or features in partially overlapping data • BIRSBIO2020.scProteomics.predictPartialOverlappingData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Predicting the missing samples or features in partially overlapping data">
<meta property="og:description" content="BIRSBIO2020.scProteomics.predictPartialOverlappingData">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BIRSBIO2020.scProteomics.predictPartialOverlappingData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/predictPartialOverlapData.html">Predicting the missing samples or features in partially overlapping data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mengchen18/BIRSBIO2020.scProteomics.predictPartialOverlappingData">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="predictPartialOverlapData_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Predicting the missing samples or features in partially overlapping data</h1>
                        <h4 class="author">Chen Meng [<a href="mailto:mengchen18@gmail.com" class="email">mengchen18@gmail.com</a>]</h4>
            
            <h4 class="date">01 August, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mengchen18/BIRSBIO2020.scProteomics.predictPartialOverlappingData/blob/master/vignettes/predictPartialOverlapData.Rmd"><code>vignettes/predictPartialOverlapData.Rmd</code></a></small>
      <div class="hidden name"><code>predictPartialOverlapData.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Partially overlapping data are often faced in the multi-omics data. For example, a cohort has been profiling using multiple omics technologies, however, every technology may only profile a subset of the cohort. We call this scenario as data with partial overlapping samples. In the data analysis, We may want to predict the missing samples in one omics dataset using the information from other omics datasets, where the samples are measured. Similarly, we may also interested in the data with partial overlapping features, e.g. genes or proteins, where all the samples are measured in all datasets, but the measured features may vary. In this vignette, we first briefly describe two methods that can be used to solve these problems, i.e. simple least square regression and multi-block principal component analysis (MBPCA). Next, we applied the two methods to solve the “missing sample” problem (using NCI60 transcriptomics data as an example) and missing feature problem (using mass-tag single-cell proteomics data). Finally, we will discuss the pros and cons of the methods and factors that may influence the prediction performance.</p>
</div>
<div id="the-methods-to-solve-the-problem-" class="section level2">
<h2 class="hasAnchor">
<a href="#the-methods-to-solve-the-problem-" class="anchor"></a>The methods to solve the problem.</h2>
<p>The most straightforward method to predict the missing feature or samples is simple linear regression. In this method, we train a linear model using the dataset where the samples/features to be predicted are measured. Then apply the model to predict the feature and sample. We implement this method in the <code>pred_lm</code> function as below:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">pred_lm</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">train.var</span>, <span class="no">test.var</span>, <span class="no">validation</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"row"</span>, <span class="st">"column"</span>)[<span class="fl">1</span>]) {
  <span class="no">xs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">x</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">x</span>[, <span class="no">train.var</span>]))
  <span class="no">prd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">xs</span>), <span class="kw">function</span>(<span class="no">m</span>) {

    <span class="co"># predicting matrix - m</span>
    <span class="no">prdmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">xs</span>), <span class="no">m</span>)

    <span class="no">rmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">prdmat</span>, <span class="kw">function</span>(<span class="no">mm</span>) {
      <span class="co"># using matrix mm to predict</span>
      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">test.var</span>, <span class="kw">function</span>(<span class="no">tv</span>) {
        <span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">x</span><span class="kw">[[</span><span class="no">mm</span>]][, <span class="no">tv</span>], <span class="no">xs</span><span class="kw">[[</span><span class="no">mm</span>]])
        <span class="no">mod</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">y</span> ~ <span class="no">.</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">df</span>)
        <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">mod</span>, <span class="no">xs</span><span class="kw">[[</span><span class="no">m</span>]])
      })
      })
    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">rmat</span>) <span class="kw">&lt;-</span> <span class="no">prdmat</span>
    <span class="no">rmat</span>$<span class="no">mean</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span>(<span class="st">"+"</span>, <span class="no">rmat</span>)/<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">rmat</span>)
    <span class="no">rmatz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">rmat</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">x</span>))))
    <span class="no">rmat</span>$<span class="no">meanZ</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span>(<span class="st">"+"</span>, <span class="no">rmatz</span>)/<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">rmat</span>)

    <span class="co">## correlation of predicted variable (test set)</span>
    <span class="no">pred.cor.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">rmat</span>, <span class="kw">function</span>(<span class="no">mm</span>) {
      <span class="kw">if</span> (<span class="no">validation</span> <span class="kw">==</span> <span class="st">"row"</span>) {
        <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]]), <span class="kw">function</span>(<span class="no">i</span>) {
          <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]][<span class="no">i</span>, <span class="no">test.var</span>]), <span class="no">mm</span>[<span class="no">i</span>, ])
        })
      } <span class="kw">else</span> {
        <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">mm</span>), <span class="kw">function</span>(<span class="no">i</span>) {
          <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]][, <span class="no">test.var</span>[<span class="no">i</span>]]), <span class="no">mm</span>[, <span class="no">i</span>])
        })
      }
      <span class="no">r</span>
    })
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">predicted</span> <span class="kw">=</span> <span class="no">rmat</span>, <span class="kw">cor.test</span> <span class="kw">=</span> <span class="no">pred.cor.test</span>)
  })
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">prd</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">xs</span>)
  <span class="no">prd</span>
}</pre></body></html></div>
<p>In this function, <code>x</code> a list of matrix/data.frame, <code>train.var</code> defines the training variables and <code>test.var</code> defines variable to be predicted. <code>validation</code> are whether on rows or on columns. The example of applying the function will come in the next section.</p>
<p>The second method that can solve the problem is multi-block principal component analysis (MBPCA). In regular PCA, we can project extra samples on the sample space of PCA [1]. When we have multiple omics data, the MBPCA can be used to find the coherent structure between datasets [2], and the missing samples in one of the datasets could be projects like regular PCA. This method is implemented in the <code>pred_mbpca</code> function.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">pred_mbpca</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">train.var</span>, <span class="no">test.var</span>, <span class="no">ncomp</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="no">method</span> <span class="kw">=</span> <span class="st">"globalScore"</span>,
                       <span class="no">validation</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"row"</span>, <span class="st">"column"</span>)[<span class="fl">1</span>], <span class="no">...</span>) {

  <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">x</span>, <span class="no">as.matrix</span>)
  <span class="no">xs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">x</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>[, <span class="no">train.var</span>])
  <span class="no">rs</span> <span class="kw">&lt;-</span> <span class="kw pkg">mogsa</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/mogsa/man/mbpca.html">mbpca</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">xs</span>, <span class="kw">ncomp</span> <span class="kw">=</span> <span class="no">ncomp</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="no">method</span>, <span class="no">...</span>)
  <span class="no">nr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">x</span>), <span class="kw">times</span> <span class="kw">=</span> <span class="no">rs</span>@<span class="kw">tab.dim</span>[<span class="fl">1</span>, ])

  <span class="no">lmats</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">x</span>), <span class="kw">function</span>(<span class="no">xx</span>) {
    <span class="no">rs</span>@<span class="kw">loading</span>[<span class="no">nr</span> <span class="kw">==</span> <span class="no">xx</span>, ]
  })
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">lmats</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">x</span>)

  <span class="no">prd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">lmats</span>), <span class="kw">function</span>(<span class="no">m</span>) {
    <span class="co"># predicting matrix - m</span>
    <span class="no">prdmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">lmats</span>), <span class="no">m</span>)
    <span class="no">rmat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">prdmat</span>, <span class="kw">function</span>(<span class="no">mm</span>) {
      <span class="no">q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">mm</span>]]) <span class="kw">%*%</span> <span class="no">lmats</span><span class="kw">[[</span><span class="no">mm</span>]]
      <span class="no">mm</span> <span class="kw">&lt;-</span> <span class="no">q</span> <span class="kw">%*%</span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">lmats</span><span class="kw">[[</span><span class="no">m</span>]])
      <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">mm</span>)
    })
    <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">rmat</span>) <span class="kw">&lt;-</span> <span class="no">prdmat</span>
    <span class="no">rmat</span>$<span class="no">mean</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span>(<span class="st">"+"</span>, <span class="no">rmat</span>)/<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">rmat</span>)
    <span class="no">rmatz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">rmat</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">x</span>))))
    <span class="no">rmat</span>$<span class="no">meanZ</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span>(<span class="st">"+"</span>, <span class="no">rmatz</span>)/<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">rmat</span>)

    <span class="co">## correlation of predicted variable (train set)</span>
    <span class="no">pred.cor.train</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">rmat</span>, <span class="kw">function</span>(<span class="no">mm</span>) {
      <span class="kw">if</span> (<span class="no">validation</span> <span class="kw">==</span> <span class="st">"row"</span>) {
        <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]]), <span class="kw">function</span>(<span class="no">i</span>) {
          <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]][<span class="no">i</span>, <span class="no">train.var</span>], <span class="no">mm</span>[<span class="no">i</span>, <span class="no">train.var</span>])
        })
      } <span class="kw">else</span> {
        <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">train.var</span>), <span class="kw">function</span>(<span class="no">i</span>) {
          <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]][, <span class="no">train.var</span>[<span class="no">i</span>]], <span class="no">mm</span>[, <span class="no">train.var</span>[<span class="no">i</span>]])
        })
      }
      <span class="no">r</span>
    })

    <span class="co">## correlation of predicted variable (test set)</span>
    <span class="no">pred.cor.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">rmat</span>, <span class="kw">function</span>(<span class="no">mm</span>) {

      <span class="kw">if</span> (<span class="no">validation</span> <span class="kw">==</span> <span class="st">"row"</span>) {
        <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]]), <span class="kw">function</span>(<span class="no">i</span>) {
          <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]][<span class="no">i</span>, <span class="no">test.var</span>], <span class="no">mm</span>[<span class="no">i</span>, <span class="no">test.var</span>])
        })
        <span class="co"># r &lt;- sapply(1:nrow(x[[m]]), function(i) {</span>
        <span class="co">#   cor(unlist(x[[m]][i, test.var]), mm[i, ])</span>
        <span class="co"># })</span>
      } <span class="kw">else</span> {
        <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">test.var</span>), <span class="kw">function</span>(<span class="no">i</span>) {
          <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">x</span><span class="kw">[[</span><span class="no">m</span>]][, <span class="no">test.var</span>[<span class="no">i</span>]], <span class="no">mm</span>[, <span class="no">test.var</span>[<span class="no">i</span>]])
        })
      }
      <span class="no">r</span>
    })

    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">predicted</span> <span class="kw">=</span> <span class="no">rmat</span>, <span class="kw">cor.train</span> <span class="kw">=</span> <span class="no">pred.cor.train</span>, <span class="kw">cor.test</span> <span class="kw">=</span> <span class="no">pred.cor.test</span>)
  })
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">prd</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">lmats</span>)
  <span class="no">prd</span>
  }</pre></body></html></div>
<p>Again, the application of the function will come later section. A simple description of the parameters: <code>x</code> a list of matrix/data.frame; <code>train.var</code> the training variables; <code>test.var</code> the variables to be predicted; <code>ncomp</code> the number of components to calculate; <code>method</code> the deflation method; <code>validation</code> in the validation step, whether the correlation of rows or columns should be calculated; <code>...</code> other parameters passed to <code>mbpca</code>. The <code>ncomp</code>, <code>method</code> and <code>...</code> method are documented in the function <code>mbpca</code> in <em><code>mogsa</code></em> package.</p>
</div>
<div id="partially-overlapping-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#partially-overlapping-samples" class="anchor"></a>Partially overlapping samples</h2>
<p>In this application, we have four microarray experiments that measured the gene expression of 60 cell lines (NCI-60). Every microarray datasets contain ~200 genes expression (rows; figure below).</p>
<p><img src="../inst/images/overlapingSample.png"></p>
<p>Among them, let’s assume that the HGU95 platform has a few cell lines missed now we want to predict the gene expression in missing samples in the HGU95 platform. First, we need to load the required package and datasets</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mogsa</span>)
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="st">"../Data/NCI60_4arrays.rda"</span>)</pre></body></html></div>
<p>Indeed, in the <code>NCI60_4arrays</code> data, all four datasets have measured all 60 cell lines. But we can randomly partition our data to the training data (the samples measured in all datasets) and testing data (the samples not measured in HGU95 and will be predicted). To validate our prediction, we can correlate the predicted value with the measured values. First, let’s use 40 cell lines in training and 20 for testing.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">18</span>)
<span class="no">ss</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fl">60</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">40</span>)
<span class="no">v</span> <span class="kw">&lt;-</span> <span class="fu">pred_mbpca</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">NCI60_4arrays</span>, <span class="kw">train.var</span> <span class="kw">=</span> <span class="no">ss</span>, <span class="kw">test.var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fl">1</span>:<span class="fl">60</span>, <span class="no">ss</span>), <span class="kw">ncomp</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"globalScore"</span>)</pre></body></html></div>
<pre><code>## calculating component 1 ...
## calculating component 2 ...
## calculating component 3 ...
## calculating component 4 ...
## calculating component 5 ...</code></pre>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">v2</span> <span class="kw">&lt;-</span> <span class="fu">pred_lm</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">NCI60_4arrays</span>, <span class="kw">train.var</span> <span class="kw">=</span> <span class="no">ss</span>, <span class="kw">test.var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fl">1</span>:<span class="fl">60</span>, <span class="no">ss</span>))

<span class="co"># geth mean MZ</span>
<span class="no">t1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">v</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="st">"cor.train"</span>[, <span class="st">"meanZ"</span>])
<span class="no">t2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">v</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="st">"cor.test"</span>[, <span class="st">"meanZ"</span>])
<span class="no">l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span>(<span class="kw">function</span>(<span class="no">x</span>,<span class="no">y</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">MBPCA</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">OLS</span> <span class="kw">=</span> <span class="no">y</span>)
}, <span class="no">t1</span>, <span class="no">t2</span>, <span class="kw">SIMPLIFY</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">l</span>, <span class="kw">recursive</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">l</span>, <span class="kw">las</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Correlation (predicted vs measured)"</span>)</pre></body></html></div>
<p><img src="predictPartialOverlapData_files/figure-html/sample_fig1-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">####</pre></body></html></div>
<p>Next, we use 20 samples for training and 40 samples for testing</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">ss</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fl">60</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>)
<span class="no">v</span> <span class="kw">&lt;-</span> <span class="fu">pred_mbpca</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">NCI60_4arrays</span>, <span class="kw">train.var</span> <span class="kw">=</span> <span class="no">ss</span>, <span class="kw">test.var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fl">1</span>:<span class="fl">60</span>, <span class="no">ss</span>), <span class="kw">ncomp</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"globalScore"</span>)</pre></body></html></div>
<pre><code>## calculating component 1 ...
## calculating component 2 ...
## calculating component 3 ...
## calculating component 4 ...
## calculating component 5 ...</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">v2</span> <span class="kw">&lt;-</span> <span class="fu">pred_lm</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">NCI60_4arrays</span>, <span class="kw">train.var</span> <span class="kw">=</span> <span class="no">ss</span>, <span class="kw">test.var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fl">1</span>:<span class="fl">60</span>, <span class="no">ss</span>))


<span class="no">t1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">v</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="st">"cor.train"</span>[, <span class="st">"meanZ"</span>])
<span class="no">t2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">v</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="st">"cor.test"</span>[, <span class="st">"meanZ"</span>])
<span class="no">l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span>(<span class="kw">function</span>(<span class="no">x</span>,<span class="no">y</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">MBPCA</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">OLS</span> <span class="kw">=</span> <span class="no">y</span>)
}, <span class="no">t1</span>, <span class="no">t2</span>, <span class="kw">SIMPLIFY</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">l</span>, <span class="kw">recursive</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">l</span>, <span class="kw">las</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Correlation (predicted vs measured)"</span>)</pre></body></html></div>
<p><img src="predictPartialOverlapData_files/figure-html/sample_fig2-1.png" width="700"> We can see that 1. the MBPCA methods generally perform better than the simple linear regression; 2. the performance of linear regression drops more dramatically compared to MBPCA when the size of the training set decreases.</p>
</div>
<div id="partially-overlapping-features" class="section level2">
<h2 class="hasAnchor">
<a href="#partially-overlapping-features" class="anchor"></a>Partially overlapping features</h2>
<p>In this application, we work with the <em>mass tag</em> proteomics data provided in the <a href="https://github.com/BIRSBiointegration/Hackathon/tree/master/sc-targeted-proteomics">sc-targeted-proteomics section</a>. The expression of 39 proteins was measured on single-cell resolution among 6 patients with triple-negative tumors (Figure below).</p>
<p><img src="../inst/images/overlappingFeature.png"></p>
<p>We now assume that some of the proteins in the purple patients are not measured, we want to know could we reliably predict the expression of the missing proteins in the purple patients. First, we load the package and datasets needed</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mogsa</span>)</pre></body></html></div>
<p>Predicting the missing proteins using MBPCA</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co">######</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="st">"../Data/TN_sce.RDA"</span>)
<span class="no">s.train</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">exprlist</span><span class="kw">[[</span><span class="fl">1</span>]]), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">25</span>)
<span class="no">s.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">exprlist</span><span class="kw">[[</span><span class="fl">1</span>]]), <span class="no">s.train</span>)
<span class="no">v</span> <span class="kw">&lt;-</span> <span class="fu">pred_mbpca</span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">exprlist</span>, <span class="kw">train.var</span> <span class="kw">=</span> <span class="no">s.train</span>, <span class="kw">test.var</span> <span class="kw">=</span> <span class="no">s.test</span>, <span class="kw">ncomp</span> <span class="kw">=</span> <span class="fl">7</span>,
  <span class="kw">method</span> <span class="kw">=</span> <span class="st">"blockLoading"</span>, <span class="kw">center</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">validation</span> <span class="kw">=</span> <span class="st">"column"</span>
)</pre></body></html></div>
<pre><code>## calculating component 1 ...
## calculating component 2 ...
## calculating component 3 ...
## calculating component 4 ...
## calculating component 5 ...
## calculating component 6 ...
## calculating component 7 ...</code></pre>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">meanz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">v</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="no">cor.test</span>[, <span class="st">"meanZ"</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">meanz</span>)</pre></body></html></div>
<p><img src="predictPartialOverlapData_files/figure-html/feature_mbpca-1.png" width="700"> The <code>exprlist</code> data is reduced from the mass tag data used in the hackathon. The data could be downloaded</p>
<p><a href="https://drive.google.com/open?id=1Qb6VgVkWfy2x5Dr7kzqMAfzOLas1G6v-" class="uri">https://drive.google.com/open?id=1Qb6VgVkWfy2x5Dr7kzqMAfzOLas1G6v-</a></p>
<p>and more information about the dataset:</p>
<p><a href="https://github.com/BIRSBiointegration/Hackathon/tree/master/sc-targeted-proteomics" class="uri">https://github.com/BIRSBiointegration/Hackathon/tree/master/sc-targeted-proteomics</a></p>
<p>Next, we predict the missing proteins using simple linear regression</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">v2</span> <span class="kw">&lt;-</span> <span class="fu">pred_lm</span>( <span class="kw">x</span> <span class="kw">=</span> <span class="no">exprlist</span>, <span class="kw">train.var</span> <span class="kw">=</span> <span class="no">s.train</span>, <span class="kw">test.var</span> <span class="kw">=</span> <span class="no">s.test</span>, <span class="kw">validation</span> <span class="kw">=</span> <span class="st">"column"</span> )
<span class="no">meanz2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">v2</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span>$<span class="no">cor.test</span>[, <span class="st">"meanZ"</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">meanz2</span>)</pre></body></html></div>
<p><img src="predictPartialOverlapData_files/figure-html/feature_lm-1.png" width="700"></p>
<p>In this case, the MBPCA has a similar performance compared to simple linear regression.</p>
</div>
<div id="disussion" class="section level2">
<h2 class="hasAnchor">
<a href="#disussion" class="anchor"></a>Disussion</h2>
<p>In this exercise, we have applied MPBCA and simple linear regression to partially overlapping features or sample questions. In fact, the only difference between the two questions depends on how the matrices are transposed. We may expect MBPCA outperforms simple linear regression because the former finds the correlated pattern across multiple datasets, preventing the potential problem of overfitting to one dataset. But this is only the case for the question of partially overlapping samples. This may because the MBPCA was originally developed as a method to integrate multiple omics datasets where different variables (features) measured on the same set of samples (similar to “partial overlapping samples question”). In practice, these data are often normalized in a way that the variable distributions are comparable between samples (column). As a result, in MBPCA, we can directly center/scale each variable so that the divergence among samples is highlighted. However, scenario 2 treats proteins as samples and individual cells as variables. However, the overall abundances of different proteins are different in orders of magnitude, leading to highly correlated variables after scaling/centering. The accuracy of prediction is negatively influenced by the collinearity of scale variables.</p>
<p>Other remarks * two other categories of methods, multiple-factorial analysis and partial least square, could also be applied to solve the question, but I haven’t got the time to include all of them in the evaluation, and they share the same problems as MBPCA which I will discuss in the next point. * MBPCA is also 10-100 times faster than linear regression methods.</p>
<p>Potential improvement We have tried to scale the protein expression and it improves the prediction accuracy. I believe there are more spaces to improve by applying different preprocessing or different metrics to transform the data. A starting point of the next step would try to transform the values to marginal probabilities as in correspondence analysis.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>[1] Abdi, Herve, and Lynne J. Williams. n.d. “Principal Component Analysis.” <a href="https://doi.org/10.1002/wics.101" class="uri">https://doi.org/10.1002/wics.101</a>.</p>
<p>[2] Meng, Chen, Dominic Helm, Martin Frejno, and Bernhard Kuster. 2016. “moCluster: Identifying Joint Patterns Across Multiple Omics Data Sets.” Journal of Proteome Research 15 (3): 755-65.</p>
</div>
<div id="session-information" class="section level2">
<h2 class="hasAnchor">
<a href="#session-information" class="anchor"></a>session information</h2>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</pre></body></html></div>
<pre><code>## R version 4.0.0 (2020-04-24)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.4 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] mogsa_1.23.1
## 
## loaded via a namespace (and not attached):
##  [1] genefilter_1.71.0    gtools_3.8.2         xfun_0.16           
##  [4] splines_4.0.0        lattice_0.20-41      graphite_1.35.1     
##  [7] vctrs_0.3.2          htmltools_0.5.0      stats4_4.0.0        
## [10] yaml_2.2.1           blob_1.2.1           XML_3.99-0.5        
## [13] survival_3.2-3       rlang_0.4.7          pkgdown_1.5.1       
## [16] DBI_1.1.0            rappdirs_0.3.1       BiocGenerics_0.35.4 
## [19] bit64_4.0.2          stringr_1.4.0        svd_0.5             
## [22] caTools_1.18.0       memoise_1.1.0        evaluate_0.14       
## [25] Biobase_2.49.0       knitr_1.29           IRanges_2.23.10     
## [28] parallel_4.0.0       AnnotationDbi_1.51.3 GSEABase_1.51.1     
## [31] Rcpp_1.0.5           corpcor_1.6.9        KernSmooth_2.23-17  
## [34] xtable_1.8-4         backports_1.1.8      checkmate_2.0.0     
## [37] gdata_2.18.0         desc_1.2.0           S4Vectors_0.27.12   
## [40] graph_1.67.1         annotate_1.67.0      fs_1.5.0            
## [43] bit_4.0.3            gplots_3.0.4         digest_0.6.25       
## [46] stringi_1.4.6        rprojroot_1.3-2      grid_4.0.0          
## [49] tools_4.0.0          bitops_1.0-6         magrittr_1.5        
## [52] RCurl_1.98-1.2       RSQLite_2.2.0        cluster_2.1.0       
## [55] crayon_1.3.4         MASS_7.3-51.6        Matrix_1.2-18       
## [58] assertthat_0.2.1     rmarkdown_2.3        httr_1.4.2          
## [61] R6_2.4.1             compiler_4.0.0</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Chen Meng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
